# Sirius3 LED コントローラー

このアプリケーションはSirius3のLEFT EARとRIGHT EARデバイスに接続して、LEDの色を制御するためのGUIツールです。

## 必要条件

- Python 3.7以上
- PySide6
- bleak (Bluetoothデバイスとの通信用、マルチプラットフォーム対応)

## インストール

1. 必要なパッケージをインストールします。

```bash
pip install -r requirements.txt
```

## 使用方法

1. アプリケーションを起動します。

```bash
python sirius3_led_controller.py
```

2. 「LEFT EAR 接続」または「RIGHT EAR 接続」ボタンをクリックして、デバイスに接続します。
3. カラーピッカーで色を選択するか、色相スライダーを調整して色を変更します。
4. 「自動色相変化モード」をオンにすると、デバイス側で自動的に色が変化します。
   - 色相スライダーで設定した値から色相の自動変化が始まります。
   - 自動モードでは、色相値は継続的に変化しますが、スライダーの位置は変わりません。
   - **重要**: 自動モードを適用するときは、設定適用後に数秒待つと色が変化し始めます。
5. 「LEFT EARに適用」「RIGHT EARに適用」「両方に適用」ボタンのいずれかをクリックして、設定を適用します。

## プラットフォーム別の注意事項

### Windows & macOS
- bleakライブラリを使用しているため、追加設定なしで動作します。
- macOSでは、Bluetoothアクセス権限を許可する必要があるかもしれません。

### Linux
- Linuxで動作させる場合、ユーザーがBluetooth権限を持っている必要があります：

```bash
sudo setcap 'cap_net_raw,cap_net_admin+eip' $(readlink -f $(which python3))
```

または、sudoで実行：

```bash
sudo python sirius3_led_controller.py
```

## トラブルシューティング

- Bluetoothデバイスのスキャンには数秒かかることがあります。
- デバイスが見つからない場合は、デバイスの電源が入っていること、Bluetooth機能が有効であることを確認してください。
- macOSまたはWindowsでBluetooth接続に問題がある場合は、システムのBluetooth設定を確認し、システムのBluetooth設定からデバイスを一度削除してから再試行してください。
- 自動色相変化モードが適用されない場合は、設定適用後にデバイスのLEDが徐々に色を変えていくことを確認してください。色の変化は緩やかに行われます。
- 自動モードでは、スライダーで設定した色相から変化が始まります。色相が変化しているのに自動モードが動作していないように見える場合は、しばらく待つと色相の変化が見えてくることがあります。
- 自動色相変化モードが動作しない場合：
  1. アプリケーションを再起動してみてください。
  2. デバイスの電源を一度切って再接続してみてください。
  3. モードを適用した後、数秒待ってみてください。色相の変化は緩やかです。
  4. 「自動色相変化モード」チェックボックスをオン/オフして再度適用してみてください。
